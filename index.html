<!-- PrimeXMusic Blogger - Automatic + Search + No API Key -->
<style>
body {
  margin: 0;
  font-family: 'Arial', sans-serif;
  background: linear-gradient(135deg, #1a1a1a, #2e2e2e);
  color: #fff;
}
#primeXMusic { max-width:1100px; margin:auto; padding:20px; }
h1 { text-align:center; margin-bottom:20px; color:#00e5ff; text-shadow:0 0 12px #00e5ff; }
#searchForm input { padding:10px; width:60%; border-radius:6px 0 0 6px; border:none; }
#searchForm button { padding:10px 15px; border:none; background:#00e5ff; color:#000; border-radius:0 6px 6px 0; cursor:pointer; }
#music-container { display:flex; flex-wrap:wrap; gap:15px; justify-content:center; }
.song-card { width:200px; cursor:pointer; background:#111; border-radius:8px; overflow:hidden; box-shadow:0 4px 10px rgba(0,0,0,0.6); transition:0.3s; }
.song-card:hover { transform:scale(1.05); }
.song-card img { width:100%; display:block; }
.song-card p { text-align:center; padding:5px; font-size:14px; }

/* Modal Player */
#playerModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); align-items:center; justify-content:center; z-index:1000; }
#playerModal iframe { width:100%; height:450px; border:none; border-radius:8px; }
#playerModal button { position:absolute; top:5px; right:10px; font-size:20px; border:none; background:none; color:#fff; cursor:pointer; }
.download-btn { background:#00ffae; color:#000; padding:5px 8px; border-radius:4px; text-align:center; display:block; margin:5px auto 10px auto; font-size:12px; text-decoration:none; }

/* Welcome Popup */
#welcomePopup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); align-items:center; justify-content:center; z-index:2000; }
#welcomePopup .popup-content { background:#111; padding:30px; border-radius:10px; text-align:center; max-width:400px; color:#fff; }
#welcomePopup .popup-content h2 { color:#00e5ff; margin-bottom:15px; }
#welcomePopup .popup-content a { display:inline-block; padding:10px 20px; background:#00ffae; color:#000; border-radius:6px; text-decoration:none; margin-top:10px; font-weight:bold; }
#welcomePopup .popup-content button { margin-top:15px; padding:8px 15px; background:#007bff; color:#fff; border:none; border-radius:6px; cursor:pointer; }
</style>

<div id="primeXMusic">
  <h1>PrimeXMusic</h1>

  <!-- Search -->
  <form id="searchForm">
    <input id="searchInput" type="text" placeholder="Search songs...">
    <button type="submit">Search</button>
  </form>

  <!-- Song Grid -->
  <div id="music-container"></div>
</div>

<!-- Player Modal -->
<div id="playerModal">
  <button id="closeModal">âœ•</button>
  <iframe id="player" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  <a id="downloadLink" class="download-btn" target="_blank">Download MP3</a>
</div>

<!-- Welcome Popup -->
<div id="welcomePopup">
  <div class="popup-content">
    <h2>Welcome to PrimeXMusic!</h2>
    <p>Join our Telegram channel for latest updates and music:</p>
    <a href="https://t.me/PrimeXprem07" target="_blank">Join Telegram</a>
    <br>
    <button id="closeWelcome">Continue to site</button>
  </div>
</div>

<script>
// ========== WELCOME POPUP ==========
window.addEventListener('load', function(){
  if(!localStorage.getItem('primeXMusicVisited')){
    document.getElementById('welcomePopup').style.display = 'flex';
    localStorage.setItem('primeXMusicVisited', 'yes');
  }
});
document.getElementById('closeWelcome').addEventListener('click', function(){
  document.getElementById('welcomePopup').style.display = 'none';
});

// ========== FETCH MUSIC WITHOUT API KEY ==========
function loadTrendingMusic(){
  fetch("https://piped.video/api/v1/trending")
  .then(res => res.json())
  .then(data => displaySongs(data))
  .catch(() => {
    document.getElementById("music-container").innerHTML = "<p>Unable to load songs.</p>";
  });
}

// SEARCH MUSIC
function searchMusic(query){
  fetch("https://piped.video/api/v1/search?q=" + encodeURIComponent(query))
  .then(res => res.json())
  .then(data => displaySongs(data.items))
  .catch(() => {
    document.getElementById("music-container").innerHTML = "<p>Error searching songs.</p>";
  });
}

// DISPLAY SONGS
function displaySongs(list){
  let box = document.getElementById("music-container");
  box.innerHTML = "";

  list.forEach(video => {
    if(!video.thumbnail) return;

    let card = document.createElement("div");
    card.className = "song-card";

    card.innerHTML = `
      <img src="${video.thumbnail}" onclick="playSong('${video.id}')">
      <p>${video.title}</p>
    `;

    box.appendChild(card);
  });
}

// PLAY SONG IN MODAL
function playSong(id){
  let modal = document.getElementById("playerModal");
  let player = document.getElementById("player");
  let download = document.getElementById("downloadLink");

  player.src = `https://www.youtube.com/embed/${id}?autoplay=1`;
  download.href = `https://www.yt-download.org/api/button/mp3/${id}`;

  modal.style.display = "flex";
}

// CLOSE MODAL
document.getElementById("closeModal").addEventListener("click", function(){
  document.getElementById("playerModal").style.display = "none";
  document.getElementById("player").src = "";
});

// SEARCH FORM ACTION
document.getElementById("searchForm").addEventListener("submit", function(e){
  e.preventDefault();
  let q = document.getElementById("searchInput").value.trim();
  if(q) searchMusic(q);
});

// AUTO LOAD TRENDING MUSIC ON PAGE LOAD
loadTrendingMusic();
</script>
